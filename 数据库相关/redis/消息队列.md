# 前言  
在一般的程序设计中，我们都会用到消息队列。为啥要用消息队列呢？无非就是为了程序的解藕，错峰，异步。  
所谓异步，就是可以同时做的事情，就不需要等待前一个任务完成再继续。例如充值话费，充值和返还积分，这两个操作可以在扣费成功
后同时进行。使用这种策略，可以大大提高接口的响应速度。
错峰就是大量流量流入，为了避免操作系统处理压力过大，可以使用消息队列将请求保存起来，然后根据系统的抗压能力分批处理。常见的
例子有：12306春节购票，双11淘宝活动已经各类电商网站的秒杀等等
解藕，就是将系统的功能拆分，避免写在一块，难以维护。例如充值系统，返现系统，积分系统等等。通过消息队列发送信息，让各个子系统
独立处理自己的业务。

# 技术选型
市面上，支持消息队列的中间件有很多，如Redis、Activemq、Rabbitmq、Rocketmq、Kafka等等。那么，改选用哪种呢？
我们先来分析各个中间件的一个优缺点  

redis优点，单线程，天生支持线程安全，吞吐量十万级别，社区获取度高。缺点，不支持事务。所以，在对事务要求严格的应用的，不可以使用
redis 

Activemq缺点：有较低的丢失消息的风险，吞吐量为万级，优点：毫秒级响应。

Rabbitmq优点，微秒级响应，消息丢失概率低，基本不丢，吞吐量为万级。缺点，使用erlang开发，可能对于程序员不友好，社区获取度中等。

Rocketmq优点，支持分布式，通过参数优化，响应为毫秒级，可实现消息0丢失，吞吐量为10万级，社区获取度高，阿里开源。

kafka优点，支持分布式，通过参数优化，响应为毫秒级，可实现消息0丢失，吞吐量为10万级，社区获取度高，通常用在对实时性要求高的业务场景，比如
实时计算，日志分析等等。

详情如图所示：

可见，这些中间件各有优缺点，我们在做技术选型的，同参考他们的一个优缺点及业务量。

